<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymer-fontawesome/polymer-fontawesome.html">
<link rel="import" href="../bower_components/sortable-table/sortable-table.html">
<link rel="import" href="../bower_components/core-list/core-list.html">

<script src="../bower_components/js-xlsx/dist/jszip.js"></script>
<script src="../bower_components/js-xlsx/dist/xlsx.min.js"></script>

<link rel="import" href="../lib/jsorolla/src/lib/components/opencga/jso-header.html">
<link rel="import" href="../lib/jsorolla/src/lib/components/opencga/jso-project-browser.html">
<link rel="import" href="../lib/jsorolla/src/network-viewer/jso-network-viewer.html">

<polymer-element name="cell-maps-element">
    <template>
        <style>
            :host {
                display: block;
                position: relative;

                cursor: default;
                font-size: 13px;
            }
            jso-project-browser {
                height: calc(100vh - 60px);
            }

            jso-network-viewer {
                height: calc(100vh - 90px);
            }
        </style>
        <jso-header selectedOption="{{selectedOption}}" userData="{{userData}}" appTitle="Cell Maps"
                    description="Systems Biology Visualization">

        </jso-header>
        <jso-project-browser hidden?="{{selectedOption != 'projects' }}" userData="{{userData}}"
                             selectedProject="{{selectedProject}}" selectedStudy="{{selectedStudy}}">
        </jso-project-browser>

        <jso-network-viewer
                id="networkViewer"
                hide="{{selectedOption != 'home'}}"
                >
        </jso-network-viewer>



    </template>
    <script>
        Polymer({
            created: function () {
                this.selectedOption = 'home';

                this.userData;

                this.selectedProject;
                this.selectedStudy;

                this.saveInProgress = false;
            },
            ready: function () {
                var me = this;
                this.networkViewer = this.$.networkViewer;
                this._loadNetworkSessionLocalStorage();

                setInterval(function () {
                    if (me.saveInProgress == false) {
                        me.saveInProgress = true;
                        me.networkViewer.saveLocalStorage();
                        me.saveInProgress = false;
                    } else {
                        console.log("saveInProgress is true");
                    }
                }, 15000);
            },
            _loadNetworkSessionLocalStorage: function () {
                if (this.networkViewer.loadLocalStorage()) {
                    console.log('Session found :), restoring information... ')

                } else {
                    console.log('Session not found :( ')
                }
            },
            __iliketomoveit: function () {
                this.$.networkViewer.setLayout('Force directed (simulation)')
            },
        });
    </script>
</polymer-element>
